webpackJsonp([0],{"+LIb":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return a(e,[{key:"selectContent",value:function(e){var t=location.hash.replace(/^#\//,""),n=function e(n,i,a){for(var o="",r=2*i;r>0;r--)o+="-";return a.forEach(function(a){n+="<option "+(t===String(a.id)?"selected":"")+' value="'+a.id+'">'+o+a.name+"</option>",n=e(n,i+1,a.child)}),n}("",0,e.child);return 0===e.child.length?n+='<option value="newfolder_'+e.id+'">No folder</option>':n+='<option value="newfolder_'+e.id+'">New Folder</option>',n}},{key:"treeContent",value:function(e,t){var n=e.id;if(e=e.child,0===e.length)return'<button class="btn new-folder" data-root="'+n+'">Create a folder</button>';var i=location.hash.replace(/^#\//,"").split("/")[0];return function e(n,a){return a.forEach(function(a){var o=a.child.length>0;n+='\n<li class="tree-item '+(o?"expandable":"")+" "+(o&&t.indexOf(String(a.id))>-1?"expanded":"")+'">\n<div class="tree-node">\n  <a href="#/'+a.id+'" data-id="'+a.id+'" class="item-title '+(i===String(a.id)?"selectedFolder":"")+'">'+a.name+'<div class="folder-control"><i class="rename-folder"></i><i class="create-sub"></i><i class="remove-folder"></i></div></a>\n</div>',o&&(n+='<div class="sub-node"><ul class="tree">',n=e(n,a.child),n+="</ul></div>"),n+="</li>"}),n}("",e)}},{key:"noteLists",value:function(e){var t=location.hash.replace(/^#\//,"").split("/")[1];return e.note.reduce(function(n,i){return n+='<li class="note '+(t===String(i.id)?"selectedNote":"")+' " data-folder="'+e.id+'" data-id="'+i.id+'"><a href="#/'+e.id+"/"+i.id+'">'+i.title+'</a><span class="create-date">'+new Date(Date.now()).toLocaleDateString()+'</span></span><button class="remove-item"></button></li>\n'},"")}},{key:"contentBody",value:function(e){return"<p>"+e.content+"</p>"}}]),e}();t.a=o},"3xYG":function(e,t,n){"use strict";function i(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelector(e)}function a(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelectorAll(e)}function o(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"==typeof e&&(e=document.querySelector(e)),e.addEventListener(t,n,i)}function r(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];"string"==typeof e&&(e=document.querySelector(e)),o(e,n,function(n){for(var a=n.target,o=e.querySelectorAll(t),r=o.length;r--;)if(o[r]===a){i.call(a,n);break}},a)}t.c=i,t.d=a,t.b=o,t.a=r},"60Pi":function(e,t){},MgqM:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=n("3xYG"),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){i(this,e),this.template=t,this.doms={body:Object(a.c)("body"),create:Object(a.c)(".create"),contentContainer:Object(a.c)(".content-container"),textarea:Object(a.c)("textarea"),save:Object(a.c)(".save"),selectFolder:Object(a.c)(".select-folder"),overlay:Object(a.c)(".overlay"),overlayCancel:Object(a.c)(".overlay-cancel"),overlayConfirm:Object(a.c)(".overlay-confirm"),overlayInput:Object(a.c)(".overlay input"),tree:Object(a.c)(".tree-container > .tree"),noteLists:Object(a.c)(".list-container ul"),contentTitle:Object(a.c)(".content .title"),contentBody:Object(a.c)(".content-body"),contentHeader:Object(a.c)(".content header"),contentPreview:Object(a.c)(".content .preview"),contentSave:Object(a.c)(".content .save"),contentEdit:Object(a.c)(".content .edit"),contentRemove:Object(a.c)(".content .remove"),contentCopy:Object(a.c)(".content .copy"),createNewFolder:Object(a.c)(".new-folder")},this.expandedTree=[],this.bindCreate(),this.bindSelect(),this.bindCancelOverlay(),this.bindOverlayInput(),this.bindFolderRename(),this.bindCreateSubFolder(),this.bindToggleFolder(),this.bindCreateNewFolder(),this.bindContentPreview()}return o(e,[{key:"bindToggleFolder",value:function(){var e=this;Object(a.a)(this.doms.body,".item-title","dblclick",function(t){var n=t.target,i=n.parentNode.parentNode;if(i.classList.contains("expandable")){i.classList.toggle("expanded"),e.recordExpandedStatus(i,n.dataset.id);var o=Object(a.d)(".tree-item",i);Array.prototype.forEach.call(o,function(e){e.classList.remove("expanded")})}},!1)}},{key:"bindSelectFolderList",value:function(e){var t=this;Object(a.a)(this.doms.body,".item-title","click",function(n){var i=n.target;Object(a.d)(".item-title").forEach(function(e){return e.classList.remove("selectedFolder")}),i.classList.add("selectedFolder"),e(t.folder)},!1)}},{key:"recordExpandedStatus",value:function(e,t){var n=e.classList.contains("expanded"),i=this.expandedTree.indexOf(t);i<0?n&&this.expandedTree.push(t):n||this.expandedTree.splice(i,1)}},{key:"updateNoteList",value:function(e){this.doms.noteLists.innerHTML=this.template.noteLists(e)}},{key:"bindCreate",value:function(){var e=this;Object(a.b)(this.doms.create,"click",function(t){t.preventDefault(),e.doms.textarea.value="",e.doms.contentContainer.classList.add("edit"),e._fixTextareaHeight()},!1)}},{key:"_fixTextareaHeight",value:function(){var e=parseInt(window.innerHeight);this.doms.textarea.style.minHeight=e-188+"px"}},{key:"bindSave",value:function(e){var t=this;Object(a.b)(this.doms.save,"click",function(n){n.preventDefault();var i={mode:t.doms.textarea.dataset.mode,id:t.doms.textarea.dataset.id};if(t.doms.selectFolder.value.match(/newfolder_/))return void alert("Please create a folder using the left button first.");e(t.doms.textarea.value,t.doms.selectFolder.value,i)},!1)}},{key:"bindSelect",value:function(){var e=this;Object(a.b)(this.doms.selectFolder,"change",function(t){var n=t.target,i=n.value.split("_");"newfolder"===i[0]&&(e.parentName=i[1],e.activeOverlay())})}},{key:"bindCancelOverlay",value:function(){var e=this;Object(a.b)(this.doms.overlayCancel,"click",function(t){t.preventDefault(),e.CancelOverlay()},!1)}},{key:"bindConfirmOverlay",value:function(e){var t=this;Object(a.b)(this.doms.overlayConfirm,"click",function(n){n.preventDefault();var i=t.doms.overlayInput.value.trim();i.length>0&&e(t.parentName,t.oldName,i)},!1)}},{key:"bindOverlayInput",value:function(){var e=this;Object(a.b)(this.doms.overlayInput,"input",function(t){t.target;e.overlayErrorClear()})}},{key:"CancelOverlay",value:function(){this.doms.overlay.classList.remove("active")}},{key:"activeOverlay",value:function(){this.doms.overlay.classList.add("active"),this.doms.overlayInput.focus()}},{key:"overlayError",value:function(){this.doms.overlay.classList.add("error")}},{key:"overlayErrorClear",value:function(){this.doms.overlay.classList.remove("error")}},{key:"updateSelectFolder",value:function(e){this.doms.selectFolder.innerHTML=this.template.selectContent(e)}},{key:"clearStatus",value:function(){this.parentName="",this.oldName="",this.doms.overlayInput.value="",this.CancelOverlay(),this.resetTextarea()}},{key:"updateTree",value:function(e){this.doms.tree.innerHTML=this.template.treeContent(e,this.expandedTree)}},{key:"bindFolderRename",value:function(){var e=this;Object(a.a)(this.doms.body,".rename-folder","click",function(t){t.preventDefault(),e.oldName=t.target.parentNode.parentNode.dataset.id,e.activeOverlay()},!1)}},{key:"bindFolderRemove",value:function(e){Object(a.a)(this.doms.body,".remove-folder","click",function(t){t.preventDefault(),e(t.target.parentNode.parentNode.dataset.id)},!1)}},{key:"bindCreateSubFolder",value:function(){var e=this;Object(a.a)(this.doms.body,".create-sub","click",function(t){t.preventDefault(),e.parentName=t.target.parentNode.parentNode.dataset.id,e.expandedTree.indexOf(e.parentName)<0&&e.expandedTree.push(e.parentName),e.activeOverlay()},!1)}},{key:"bindCreateNewFolder",value:function(){var e=this;Object(a.a)(this.doms.tree,".new-folder","click",function(t){t.preventDefault(),e.parentName=t.target.dataset.root,e.activeOverlay()},!1)}},{key:"bindItemRemove",value:function(e){Object(a.a)(this.doms.body,".remove-item","click",function(t){t.preventDefault();var n=t.target.parentNode;e(n.dataset.id,n.dataset.folder)},!1)}},{key:"showItem",value:function(e,t){if(!e)return this.doms.textarea.value="",this.doms.contentContainer.classList.add("edit"),void this._fixTextareaHeight();this.doms.contentContainer.classList.remove("edit"),this.doms.contentTitle.innerHTML=e.title,this.doms.contentHeader.dataset.id=e.id,this.doms.contentHeader.dataset.folder=t,this.doms.contentBody.innerHTML=this.template.contentBody(e)}},{key:"bindContentPreview",value:function(e){Object(a.a)(this.doms.contentContainer,".preview","click",function(e){e.preventDefault(),alert("This is for markdown, but it is not implemented now, maybe later.")})}},{key:"bindEdit",value:function(e){Object(a.b)(this.doms.contentEdit,"click",function(t){t.preventDefault();var n=t.target.parentNode.parentNode;e(n.dataset.id,n.dataset.folder)})}},{key:"fillTextarea",value:function(e,t){this.doms.textarea.value=e.content,this.doms.textarea.dataset.mode="edit",this.doms.textarea.dataset.id=e.id,this.doms.selectFolder.value=t,this._fixTextareaHeight(),this.doms.contentContainer.classList.add("edit")}},{key:"resetTextarea",value:function(){this.doms.textarea.dataset.mode="",this.doms.textarea.dataset.id="",this.doms.selectFolder.value=""}},{key:"bindContentRemove",value:function(e){Object(a.b)(this.doms.contentRemove,"click",function(t){t.preventDefault();var n=t.target.parentNode.parentNode;e(n.dataset.id,n.dataset.folder)})}}]),e}();t.a=r},R2a2:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n){i(this,e),this.view=t,this.model=n,this.view.bindSelectFolderList(this.filterNotes.bind(this)),this.view.bindSave(this.save.bind(this)),this.view.bindConfirmOverlay(this.saveOverlayInput.bind(this)),this.view.bindFolderRemove(this.removeFolder.bind(this)),this.view.bindItemRemove(this.removeItem.bind(this)),this.view.bindContentRemove(this.removeItem.bind(this)),this.view.bindEdit(this.edit.bind(this))}return a(e,[{key:"render",value:function(){var e=this;this.view.clearStatus(),this.showNote(void 0),this.model.getData(function(t){e.view.updateSelectFolder(t),e.view.updateTree(t),location.hash.length>2&&e.route()})}},{key:"route",value:function(){var e=location.hash.replace(/^#\//,"");this.uri=e.split("/"),this.filterNotes(this.uri[0]),this.uri.length>1&&this.showNote(this.uri)}},{key:"filterNotes",value:function(e){var t=this;this.model.getFolder(e,function(e){t.view.updateNoteList(e)})}},{key:"showNote",value:function(e){var t=this;if(!e)return this.view.showItem(void 0);this.model.getItem(e[0],e[1],function(n){t.view.showItem(n,e[0])})}},{key:"save",value:function(e,t,n){var i=this,a=n.mode,o=n.id,r=e.trim();r.length<1||("edit"===a?this.model.editNote({data:r,folder:t,id:o},function(e){var n="#/"+t+"/"+e.id;window.history.pushState(null,null,n),i.render()}):this.model.newNote({data:r,folder:t},function(e){var n="#/"+t+"/"+e.id;window.history.pushState(null,null,n),i.render()}))}},{key:"saveOverlayInput",value:function(e,t,n){var i=this;t?this.model.renameFolder(t,n,function(e){i.render()}):this.model.newFolder(n,e,function(e,t){var n="#/"+t.id;window.history.pushState(null,null,n),i.render(e)})}},{key:"removeFolder",value:function(e){var t=this;this.model.removeFolder(e,function(e){t.render()})}},{key:"removeItem",value:function(e,t){var n=this;this.model.removeItem(e,t,function(e){window.history.pushState(null,null,"#/"+n.uri[0]),n.render()})}},{key:"edit",value:function(e,t){var n=this;this.model.getItem(t,e,function(e){n.view.fillTextarea(e,t)})}}]),e}();t.a=o},gCoH:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"db";i(this,e),this.name=n,t.getItem&&t.setItem&&t.removeItem?(this.inMemory=!1,this.ls=t):(this.inMemory=!0,this.ls={data:{},getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t},removeItem:function(e){delete this.data[e]}}),this.items=JSON.parse(this.ls.getItem(n)||"[]")}return a(e,[{key:"set",value:function(e){this.ls.setItem(this.name,JSON.stringify(e))}},{key:"get",value:function(){return JSON.parse(this.ls.getItem(this.name))}},{key:"remove",value:function(){this.ls.removeItem(this.name)}},{key:"isInMemory",value:function(){return this.inMemory}},{key:"name",value:function(){return this.name}}]),e}();t.a=o},lOx2:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.store=t;var n=this.store.get();n?this.data=n:(this.data={id:String(Date.now()),name:"Root",note:[],child:[]},this.sync())}return a(e,[{key:"getData",value:function(e){e(this.data)}},{key:"newNote",value:function(e,t){var n=this._makeNote(e);this.findFolder(this.data,e.folder,function(e,t){e.note.push(n)}),this.sync(),t(n)}},{key:"findFolder",value:function(e,t,n){!function e(t,i,a){if(String(t.id)===String(a))return n(t,i);for(var o=t.child.length-1;o>=0;o--){e(t.child[o],t,a)}}(e,e,t)}},{key:"_makeNote",value:function(e){return{id:String(Date.now()),title:this._generateTitle(e.data),content:e.data}}},{key:"_generateTitle",value:function(e){var t=e.match(/(^(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)\n/i);return!t||t[1].length>30?e.slice(0,31):t[1]}},{key:"newFolder",value:function(e,t,n){var i=this;this.findFolder(this.data,t,function(t,a){var o=i._generateFolder(e);t.child.push(o),i.sync(),n(i.data,o)})}},{key:"_generateFolder",value:function(e){return{id:String(Date.now()),name:e,note:[],child:[]}}},{key:"renameFolder",value:function(e,t,n){var i=this;this.findFolder(this.data,e,function(e,a){return e.name=t,i.sync(),n(i.data)})}},{key:"removeFolder",value:function(e,t){var n=this;this.findFolder(this.data,e,function(i,a){return a.child=a.child.filter(function(t){return String(t.id)!==String(e)}),n.sync(),t(n.data)})}},{key:"removeItem",value:function(e,t,n){return this.findFolder(this.data,t,function(t,n){t.note=t.note.filter(function(t){return String(t.id)!==String(e)})}),this.sync(),n(this.data)}},{key:"getItem",value:function(e,t,n){this.findFolder(this.data,e,function(e,i){n(e.note.find(function(e){return e.id===t}))})}},{key:"editNote",value:function(e,t){var n=this,i=e.data,a=e.folder,o=e.id;this.findFolder(this.data,a,function(e,a){var r=e.note.find(function(e){return String(e.id)===String(o)});r.title=n._generateTitle(i),r.content=i,n.sync(),t(r)})}},{key:"getFolder",value:function(e,t){this.findFolder(this.data,e,function(e,n){t(e)})}},{key:"sync",value:function(){this.store.set(this.data)}}]),e}();t.a=o},lVK7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("uMhA"),a=(n.n(i),n("60Pi")),o=(n.n(a),n("gCoH")),r=n("3xYG"),s=n("R2a2"),l=n("MgqM"),c=n("lOx2"),d=n("+LIb"),u=new o.a(localStorage,"scrachy_note"),v=new c.a(u),f=new l.a(new d.a),h=new s.a(f,v);Object(r.b)(window,"load",h.render.bind(h)),Object(r.b)(window,"hashchange",h.route.bind(h))},uMhA:function(e,t){}},["lVK7"]);